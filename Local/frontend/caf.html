<!DOCTYPE html>
<html lang="en">
<head>
    <title>匠迪云</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <link rel="shortcut icon" href="./images/favicon.ico"/>

    <link rel="stylesheet" href="./dist/css/bootstrap.css">
    <link rel="stylesheet" href="./dist/css/jeuic.css">
    <link rel="stylesheet" href="./dist/css/table.css">
    <link rel="stylesheet" href="./dist/css/common.css">
    <link rel="stylesheet" href="./dist/css/caf.css">


</head>
<body>
<nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href=""><img src="images/logo1.png" alt="" title="匠迪云安全"></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse" >

            <ul class="nav navbar-nav ">
                <li><a href="codescan.html">代码扫描</a></li>
                <li><a href="caa.html" style="border-bottom: 4px solid #65b6fc;">代码分析</a></li>
                <li><a href="proman.html">工程管理</a></li>
                <li><a href="contact.html">联系我们</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li><a>匠人之心</a></li>
                <li><a href="">注销</a></li>
            </ul>

        </div>
    </div>
</nav>





<div class="container">
    <div class="row rowpiece">
        <div class="col-xs-4 col-sm-2 col-md-2 col-lg-1 subhead" ><a href="caa.html" >总览视图</a></div>
        <ul  class="nav nav-tabs" style="border-bottom: 1px solid #262d37">
            <!--<div class="col-xs-4 col-sm-2 col-md-2 col-lg-1 subhead">-->
                <li class="subheadnext">
                    <a href="#first" data-toggle="tab" style=" background-color:rgba(34,41,48,.6);padding:4px 8px">分览视图</a>
                </li>
                <br>
                <hr>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        java
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        php
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        python
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        aspx
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        objective-c
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        jsp
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        asp
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        c
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        c++
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        ruby
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        c#
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        perl
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        javascript
                    </a>
                </li>
                <li class="subheadnext">
                    <a href="#language" data-toggle="tab" class="tab-titles ">
                        审计
                    </a>
                </li>
            <!--</div>-->
        </ul>
    </div>


    <div  class="row tab-content" style="margin-top: 1rem">
        <div class="tab-pane fade in active" id="first">

            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 rl">
                <div class="message-left">
                   <div class="level-con">

                       <div class="part4">
                           <p>高</p>
                           <p style="color: #c31f26">0</p>
                       </div>
                       <div class="part4">
                           <p>中</p>
                           <p style="color: #dac82c">1/9</p>
                       </div>
                       <div class="part4">
                           <p>低</p>
                           <p style="color: #199d2b">4/50</p>
                       </div>
                       <div class="part4">
                           <p>所有</p>
                           <p style="color: #0978b7">3/255</p>
                       </div>

                   </div>
                    <div class="tree-con">

                        <!--滚动条-->
                        <div class="scroll-container">
                            <div class="scroll">

                                <!--！！！！！！！！！！！！！树形图！！！！！！！！！！！！！！-->
                                    <div class="je-tree" id="trees" >
                                    </div>
                                <!--！！！！！！！！！！！！！树形图！！！！！！！！！！！！！！-->

                            </div>
                        </div>




                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8 rl">

                <div class="message-right">
                    <!----------------上面结构----标题----------------->
                    <ul  class="nav nav-tabs cre-ul" style="border-bottom:1px solid #0978b7">
                        <li  style="padding: 2px 8px">
                               检测概况
                        </li>

                       <!--推入标题-->

                    </ul>

                    <div class="iframe-con">
                        <iframe src="messshow.html" frameborder="0" class="iframe"></iframe>
                    </div>


                </div>




            </div>
        </div>
        <!---------------第二页--------------->
        <div class="tab-pane fade" id="language">

            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mainmap" id = "map0">
                <!--ec图-->
            </div>
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mainmap" id = "map1">
                <!--ec图-->
            </div>
            <table id = "table" class="table table-bordered">
                <!--表格-->
            </table>


        </div>
    </div>
</div>


<script src="./dist/js/jquery-3.1.1.min.js"></script>
<script src="./dist/js/bootstrap.min.js"></script>
<script src="./dist/js/bootstrap-table.js"></script>
<script src="./dist/js/jeTreeC.js"></script>
<script src="./dist/js/echarts.js"></script>
<script src="./dist/js/dark.js"></script>
<script>
    //ecmap 在bootstrap -tab 中没有动画
    $(window).resize(function(){
        map0.resize();
        map1.resize();
    });
    map0 = echarts.init(document.getElementById('map0'),'dark');
    map1 = echarts.init(document.getElementById('map1'),'dark');
        option0 = {
            backgroundColor:'#2a323d',
            title : {
                text: '风险分类视图',
                x:'left'
            },
            tooltip : {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            legend: {
                x : '4%',
                y : 'center',
                width:'16%',
                height:'100%',
                data:['高','中','底']
            },
            calculable : true,
            series : [
                {
                    name:'面积模式',
                    type:'pie',
                    radius : [30, 110],
                    center : ['50%', '50%'],
                    roseType : 'area',
                    data:[
                        {value:10, name:'高'},
                        {value:5, name:'中'},
                        {value:15, name:'底'}
                    ]
                }
            ]
        };
        option1 = {
            backgroundColor:'#2a323d',
                    title : {
                text: '程度分类视图',

                        x:'left'
            },
            tooltip : {
                trigger: 'item',
                        formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            legend: {
                x : '86%',
                y : 'center',
                width:'16%',
                height:'100%',
                data:['rose1','rose2','rose3','rose4','rose5','rose6','rose7','rose8']
            },
            calculable : true,
                series : [
                {
                    name:'面积模式',
                    type:'pie',
                    radius : [30, 110],
                    center : ['50%', '50%'],
                    roseType : 'area',
                    data:[
                        {value:10, name:'rose1'},
                        {value:5, name:'rose2'},
                        {value:15, name:'rose3'},
                        {value:25, name:'rose4'},
                        {value:20, name:'rose5'},
                        {value:35, name:'rose6'},
                        {value:30, name:'rose7'},
                        {value:40, name:'rose8'}
                    ]
               }
            ]
        };
        map0.setOption(option0);
        map1.setOption(option1);

</script>
<script>
    //    标题点击样式
    $(".subhead a").each(function(i){
        $(this).click(function(){
            $(".subheadnext a").removeClass("click-bgc");
        })
    })
    $(".subheadnext a").each(function(i){
        $(this).click(function(){
            $(".subheadnext a").removeClass("click-bgc");
            $(this).addClass("click-bgc");
        })
    })
    $('#table').bootstrapTable({
            url:'../data.json',
            method:'post',
            pagination:true,
            sidePagination: "server",
            singleSelect: false,
//            datalocale:"zh-US" , //表格汉化



            columns: [
            {
                field: 'id',
                title: '序号',
                align:'center',
                valign:'middle'
               
            }, {
                field: 'remark',
                title: '风险程度',
                align:'center',
                valign:'middle'
            },{
                field: 'name',
                title: '漏洞名称',
                align:'center',
                valign:'middle'
            },{
                field: 'address',
                title: '漏洞位置',
                align:'center',
                valign:'middle'
            },{
                field: 'date',
                title: '漏洞片段',
                align:'center',
                valign:'middle'
            }],



         });
  //树形及右侧父级赋高
   giveHeight()
   function giveHeight(){
       var winHeight = $(window).height();
//       树形赋高
       var treeConTop = $(".tree-con").offset().top;
       var treeConHeight = winHeight - treeConTop ;
       $(".tree-con").css("height",treeConHeight);
//右侧赋高
       var iframeConTop= $(".iframe-con").offset().top;
       var iframeConHeight = winHeight - iframeConTop - 1;

       console.log(treeConHeight+"----------------")

       $(".iframe-con").css("height",iframeConHeight);



//       给iframe 中下面区域赋高
       window.onload = function() {
           var iframeConTopHeight = $( "iframe" ).contents().find(".tab-content-top").height();
           var iframeConListHeight = $( "iframe" ).contents().find(".tabsT").height();
           var iframeBottomHeight = iframeConHeight - iframeConTopHeight - iframeConListHeight - 2;
           var iframeBottom = $( "iframe" ).contents().find(".tab-content-bottom");
           console.log(iframeBottomHeight)
           iframeBottom.css("height",iframeBottomHeight);
       };
   }
</script>
<script type="text/javascript">
    var jsonlist = [
        {
            tid: "M00",
            name: "侵犯隐私0",
            url: "",
            childlist: [
                {
                    tid: "M000",
                    name: "侵犯xinfan心烦秦东风xinfan心烦秦东风",
                    codemessage:"代码信息0",
                    describemessage:"代码描述0",
                    suggestmessage:"修复建议0",
                    refermessage:"参考信息0",
                    auditmessage:"缺陷审计0",
                    url: "",
                    childlist: ""
                },
                {
                    tid: "M001",
                    name: "侵犯01",
                    codemessage:"111",
                    describemessage:"代码描述1",
                    suggestmessage:"修复建议1",
                    refermessage:"参考信息1",
                    auditmessage:"缺陷审计1",
                    url: "",
                    childlist: ""
                }
            ]
        },
        {
            tid: "M01",
            name: "侵犯隐私1",
            url: "",
            childlist: [
                {
                    tid: "M010",
                    name: "侵犯10",
                    codemessage:"100",
                    describemessage:"代码描述10",
                    suggestmessage:"修复建议10",
                    refermessage:"参考信息10",
                    auditmessage:"缺陷审计10",
                    url: "",
                    childlist: ""
                },
                {
                    tid: "M011",
                    name: "侵犯11",
                    codemessage:"101",
                    describemessage:"代码描述11",
                    suggestmessage:"修复建议11",
                    refermessage:"参考信息11",
                    auditmessage:"缺陷审计11",
                    url: "",
                    childlist: ""
                },
                {
                    tid: "M012",
                    name: "侵犯12",
                    codemessage:"102",
                    describemessage:"代码描述12",
                    suggestmessage:"修复建议12",
                    refermessage:"参考信息12",
                    auditmessage:"缺陷审计12",
                    url: "",
                    childlist: ""
                }
            ]
        },
        {
            tid: "M02",
            name: "侵犯隐私2",
            url: "",
            childlist: [
                {
                    tid: "M020",
                    name: "侵犯20",
                    codemessage:"200",
                    describemessage:"代码描述20",
                    suggestmessage:"修复建议21",
                    refermessage:"参考信息22",
                    auditmessage:"缺陷审计23",
                    url: "",
                    childlist: ""
                },
                {
                    tid: "M021",
                    name: "侵犯22",
                    codemessage:"201",
                    describemessage:"代码描述222",
                    suggestmessage:"修复建议212",
                    refermessage:"参考信息222",
                    auditmessage:"缺陷审计232",
                    url: "",
                    childlist: ""
                },{
                    tid: "M020",
                    name: "侵犯20",
                    codemessage:"202",
                    describemessage:"代码描述022",
                    suggestmessage:"修复建议213",
                    refermessage:"参考信息223",
                    auditmessage:"缺陷审计233",
                    url: "",
                    childlist: ""
                },
                {
                    tid: "M021",
                    name: "侵犯22",
                    codemessage:"203",
                    describemessage:"代码描述4",
                    suggestmessage:"修复建议4",
                    refermessage:"参考信息4",
                    auditmessage:"缺陷审计4",
                    url: "",
                    childlist: ""
                },{
                    tid: "M020",
                    name: "侵犯20",
                    codemessage:"204",
                    describemessage:"代码描述5",
                    suggestmessage:"修复建议5",
                    refermessage:"参考信息5",
                    auditmessage:"缺陷审计5",
                    url: "",
                    childlist: ""
                },
                {
                    tid: "M021",
                    name: "侵犯22",
                    codemessage:"204",
                    describemessage:"代码描述6",
                    suggestmessage:"修复建议6",
                    refermessage:"参考信息6",
                    auditmessage:"缺陷审计6",
                    url: "",
                    childlist: ""
                },{
                    tid: "M020",
                    name: "侵犯20",
                    codemessage:"204",
                    describemessage:"代码描述7",
                    suggestmessage:"修复建议7",
                    refermessage:"参考信息7",
                    auditmessage:"缺陷审计7",
                    url: "",
                    childlist: ""
                },
                {
                    tid: "M021",
                    name: "侵犯22",
                    codemessage:"204",
                    describemessage:"代码描述8",
                    suggestmessage:"修复建议8",
                    refermessage:"参考信息8",
                    auditmessage:"缺陷审计8",
                    url: "",
                    childlist: ""
                },{
                    tid: "M020",
                    name: "侵犯20",
                    codemessage:"204",
                    describemessage:"代码描述9",
                    suggestmessage:"修复建议9",
                    refermessage:"参考信息9",
                    auditmessage:"缺陷审计9",
                    url: "",
                    childlist: ""
                },
                {
                    tid: "M021",
                    name: "侵犯22",
                    codemessage:"204",
                    describemessage:"代码描述10",
                    suggestmessage:"修复建议021",
                    refermessage:"参考信息022",
                    auditmessage:"缺陷审计023",
                    url: "",
                    childlist: ""
                }
            ]
        }
    ];
    var arr = [];
    $("#trees").jeTree({
        datas:jsonlist,
        itemfun:function (item) {
            if(item.childlist.length == 0){
                $(".folderleaf").css({"background":"url(images/checked.png) no-repeat","background-position":"0 5px"})
                $("li[treeid="+item.tid+"] .folderleaf").css({"background":"url(images/checked.png) no-repeat","background-position":"0 -36px"})
                // 点击5个问题出现
                $(".opera").css("display","none");
                $("li[treeid="+item.tid+"] .opera").css("display","block");
                console.log(item);
//                   表格信息


//                判断标题的重复性
                var indexId = item.tid;
                if($.inArray(indexId,arr) == -1){
                    arr.push(indexId);
                    creTitle(item.tid,item.name);
                    console.log(arr);
                }else if($.inArray(indexId,arr) == 1 && $(".cre-title[index="+item.tid+"]").length < 0){
                    creTitle(item.tid,item.name);
                    console.log(arr);
                }else{
                    $(".cre-li").removeClass("active");
                    $(".cre-title[index="+item.tid+"]").parents("li").addClass("active");
                }


            }
        }
    });
//    创建标题
    function creTitle(id,name){
        $(".cre-li").removeClass("active");
        var creLi = "<li class='cre-li active'><a href='#tabmessage' data-toggle='tab' class='cre-title' index = "+id+" title = "+name +">   </a><span class='cre-close'></span></li>";
        $(".cre-ul").append(creLi);
        $(".cre-title[index="+id+"]").html(name);

    }
//    点击标题添加active
    $(".cre-ul").on("click",".cre-li",function(){
        $(".cre-li").removeClass("active");
        $(event.target).addClass("active");
    })
//   点击删除标题
    $(".cre-ul").on("click",".cre-close",function(){
        var targetName = $(event.target);
        var tid =  targetName.prev("a").attr("index");

        if(targetName.parents("li").hasClass("active")){

//            ????????????????????????????????????????删除后样式赋不上
            targetName.parents("ul").children("li:last-child").addClass("active");
            console.log(targetName.parents("ul"));


            removeByValue(arr, tid);
            targetName.parents("li").remove();
        }
    })
//    删除指定元素
    function removeByValue(arr0, val) {
        for(var i=0; i<arr0.length; i++) {
            if(arr0[i] == val) {
                arr0.splice(i, 1);
                break;
            }
        }
    }
</script>
</body>
</html>